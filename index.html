<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Protein-Protein Interaction Search</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; text-align: center; }
        .header h1 { font-size: 2.5em; margin-bottom: 10px; }
        .header p { font-size: 1.1em; opacity: 0.9; }
        .search-section { padding: 30px; background: #f8f9fa; }
        .search-box { display: flex; gap: 10px; margin-bottom: 15px; }
        #searchInput { flex: 1; padding: 15px; font-size: 16px; border: 2px solid #ddd; border-radius: 8px; transition: border-color 0.3s; }
        #searchInput:focus { outline: none; border-color: #667eea; }
        #searchButton { padding: 15px 30px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; transition: transform 0.2s; font-weight: 600; }
        #searchButton:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4); }
        #searchButton:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .info-text { color: #666; font-size: 14px; margin-top: 10px; line-height: 1.5; }
        .loading { text-align: center; padding: 20px; color: #667eea; font-size: 18px; }
        .spinner { border: 3px solid #f3f3f3; border-top: 3px solid #667eea; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 20px auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .results-section { padding: 30px; }
        .result-count { margin-bottom: 20px; padding: 15px; background: #e8eaf6; border-radius: 8px; color: #667eea; font-size: 18px; font-weight: 600; }
        .uniprot-link { color: #667eea; text-decoration: none; font-weight: 600; padding: 4px 8px; border-radius: 4px; transition: all 0.2s; display: inline-block; }
        .uniprot-link:hover { background-color: #e8eaf6; text-decoration: underline; transform: translateY(-1px); }
        .external-icon { font-size: 0.8em; margin-left: 3px; }
        .table-container { overflow-x: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; background: white; }
        thead { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; position: sticky; top: 0; z-index: 10; }
        th { padding: 15px 12px; text-align: left; font-weight: 600; font-size: 13px; white-space: nowrap; }
        td { padding: 12px; border-bottom: 1px solid #eee; font-size: 13px; }
        tbody tr:hover { background-color: #f8f9fa; }
        tbody tr:last-child td { border-bottom: none; }
        .no-results { text-align: center; padding: 60px 20px; color: #999; font-size: 18px; }
        .no-results-icon { font-size: 48px; margin-bottom: 20px; }
        .error-message { background-color: #fee; color: #c33; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #c33; }
        .success-message { background-color: #efe; color: #2d7a2d; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #4caf50; }
        .info-message { background-color: #e8eaf6; color: #667eea; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #667eea; }
        .gene-info { background: linear-gradient(135deg, #e8eaf6 0%, #f3e5f5 100%); padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #667eea; }
        .gene-info strong { color: #667eea; }
        .gene-info-grid { display: grid; grid-template-columns: auto 1fr; gap: 10px; margin-top: 10px; }
        .gene-info-label { font-weight: 600; color: #667eea; }
        .highlight-cell { background-color: #fff3cd !important; font-weight: 600; }
        .score-high { color: #2d7a2d; font-weight: 600; }
        .score-medium { color: #f57c00; font-weight: 600; }
        .score-low { color: #c33; font-weight: 600; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß¨ Protein-Protein Interaction Search</h1>
            <p>Discover protein interactions with confidence scores</p>
        </div>
        <div class="search-section">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Enter gene name (e.g., TP53, BRCA1) or UniProt ID (e.g., P04637)" autocomplete="off"/>
                <button id="searchButton">üîç Search</button>
            </div>
            <div class="info-text">üí° <strong>How it works:</strong> Enter a gene name or UniProt ID. The tool will automatically convert gene names to UniProt IDs and find all protein interactions.</div>
        </div>
        <div class="results-section" id="resultsSection" style="display:none;">
            <div id="messageBox"></div>
            <div id="geneInfo"></div>
            <div id="resultCount" class="result-count"></div>
            <div class="table-container" id="resultsTable"></div>
        </div>
    </div>
    <script>
        let proteinData=[];async function loadData(){try{const e=await fetch("candidate_predictions_combined.tsv"),t=await e.text(),a=t.split("\n").filter(e=>{const t=e.trim();return t&&!t.startsWith("#")}),n=a[0].split("\t").map(e=>e.trim());proteinData=a.slice(1).filter(e=>e.trim()).map(e=>{const t=e.split("\t"),a={};return n.forEach((e,n)=>{a[e]=t[n]?.trim()||""}),a}),console.log("‚úÖ Data loaded successfully!"),console.log("üìä Total interactions:",proteinData.length),console.log("üìã Columns:",n)}catch(e){console.error("‚ùå Error loading data:",e),showMessage("Error loading data file. Please ensure candidate_predictions_combined.tsv is in the same directory.","error")}}async function geneToUniProt(e){try{const t=await fetch(`https://rest.uniprot.org/uniprotkb/search?query=gene:${e}+AND+organism_id:9606&format=json&size=5`);if(!t.ok)throw new Error("UniProt API request failed");const a=await t.json();if(a.results&&a.results.length>0){const t=a.results[0];return{uniprotId:t.primaryAccession,geneName:t.genes?.[0]?.geneName?.value||e,proteinName:t.proteinDescription?.recommendedName?.fullName?.value||"Unknown protein",organism:"Homo sapiens (Human)",found:!0}}return{found:!1}}catch(e){return console.error("Error fetching from UniProt:",e),{found:!1,error:e.message}}}function isUniProtID(e){return/^[OPQ][0-9][A-Z0-9]{3}[0-9]$|^[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}$/.test(e.toUpperCase())}function looksLikeUniProtID(e){return!(!e||e.length<6||e.length>10)&&/^[A-Z][0-9][A-Z0-9]{3,8}$/.test(e.toUpperCase())}function createUniProtLink(e,t=!1){if(!e||!looksLikeUniProtID(e))return e||"N/A";const a=t?"uniprot-link highlight-cell":"uniprot-link";return`<a href="https://www.uniprot.org/uniprotkb/${e}" target="_blank" class="${a}">${e}<span class="external-icon">‚Üó</span></a>`}function formatScore(e){if(!e||""===e)return"N/A";const t=parseFloat(e);if(isNaN(t))return e;let a="score-low";return t>=.7?a="score-high":t>=.4&&(a="score-medium"),`<span class="${a}">${t.toFixed(4)}</span>`}async function searchProtein(){const e=document.getElementById("searchInput").value.trim();if(!e)return void showMessage("Please enter a gene name or UniProt ID","error");if(0===proteinData.length)return void showMessage("Data not loaded yet. Please wait a moment and try again.","error");const t=document.getElementById("searchButton");t.disabled=!0,t.textContent="üîç Searching...",document.getElementById("resultsSection").style.display="block",document.getElementById("resultsTable").innerHTML='<div class="loading"><div class="spinner"></div><p>Searching for interactions...</p></div>',document.getElementById("messageBox").innerHTML="",document.getElementById("geneInfo").innerHTML="";let a=e.toUpperCase(),n=null;if(isUniProtID(e))showMessage(`üîç Searching for UniProt ID: <strong>${a}</strong>`,"info");else if(showMessage(`üîç Looking up UniProt ID for gene: <strong>${e}</strong>`,"info"),(n=await geneToUniProt(e)).found)a=n.uniprotId,document.getElementById("geneInfo").innerHTML=`\n                        <div class="gene-info">\n                            <div style="font-size: 18px; margin-bottom: 15px;">\n                                <strong>‚úÖ Gene Found!</strong>\n                            </div>\n                            <div class="gene-info-grid">\n                                <span class="gene-info-label">Gene Name:</span>\n                                <span>${n.geneName}</span>\n                                \n                                <span class="gene-info-label">UniProt ID:</span>\n                                <span><a href="https://www.uniprot.org/uniprotkb/${n.uniprotId}" target="_blank" class="uniprot-link">${n.uniprotId}<span class="external-icon">‚Üó</span></a></span>\n                                \n                                <span class="gene-info-label">Protein Name:</span>\n                                <span>${n.proteinName}</span>\n                                \n                                <span class="gene-info-label">Organism:</span>\n                                <span>${n.organism}</span>\n                            </div>\n                        </div>\n                    `,showMessage(`‚úÖ Successfully mapped gene "${e}" to UniProt ID: ${n.uniprotId}`,"success");else showMessage(`‚ö†Ô∏è Could not find UniProt ID for gene "${e}". Searching with original term...`,"error");const o=proteinData.filter(e=>{const t=(e.Protein1||"").toUpperCase(),n=(e.Protein2||"").toUpperCase();return t===a||n===a});console.log("üîç Searching for UniProt ID:",a),console.log("üìä Total interactions found:",o.length),displayResults(o,a),t.disabled=!1,t.textContent="üîç Search"}function displayResults(e,t){const a=document.getElementById("resultCount"),n=document.getElementById("resultsTable");if(0===e.length)return n.innerHTML=`\n                    <div class="no-results">\n                        <div class="no-results-icon">üî¨</div>\n                        <strong>No interactions found for UniProt ID: ${t}</strong>\n                        <p style="margin-top: 10px; color: #666;">\n                            This protein may not have any predicted interactions in the database,<br>\n                            or the ID might not be present in the dataset.\n                        </p>\n                    </div>\n                `,void(a.textContent="");a.innerHTML=`\n                üéØ Found <strong>${e.length}</strong> interaction${e.length>1?"s":""} \n                for UniProt ID: <strong>${t}</strong>\n            `;const o=Object.keys(e[0]);let r="<table><thead><tr>";o.forEach(e=>{r+=`<th>${e}</th>`}),r+="</tr></thead><tbody>",e.forEach(e=>{r+="<tr>",o.forEach(a=>{let n=e[a];const o="Protein1"===a&&n.toUpperCase()===t,i="Protein2"===a&&n.toUpperCase()===t;if("Protein1"===a||"Protein2"===a){const e=o||i,t=e?' class="highlight-cell"':"";n=createUniProtLink(n,e),r+=`<td${t}>${n}</td>`}else a.toLowerCase().includes("prob")||a.toLowerCase().includes("score")?(n=formatScore(n),r+=`<td>${n}</td>`):r+=`<td>${n}</td>`}),r+="</tr>"}),r+="</tbody></table>",n.innerHTML=r}function showMessage(e,t){const a=document.getElementById("messageBox");let n="info-message";"error"===t?n="error-message":"success"===t&&(n="success-message"),a.innerHTML=`<div class="${n}">${e}</div>`}document.getElementById("searchButton").addEventListener("click",searchProtein),document.getElementById("searchInput").addEventListener("keypress",e=>{"Enter"===e.key&&searchProtein()}),loadData();
    </script>
</body>
</html>
